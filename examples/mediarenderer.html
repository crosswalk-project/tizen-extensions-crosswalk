<html>
<head>
<title>MediaRenderer example</title>
</head>
<body>

<button onclick='scanNetwork()'>Scan for media renderers</button>
<!--
<button onclick='findMediaObjects()'>Scan network for media objects</button>
-->

<div id='rendererContainer'></div>
<!--
<div id='mediaObjectsContainer'></div>
-->
<script>
navigator.mediaRenderer.addEventListener('rendererfound', onRendererFound);
navigator.mediaRenderer.addEventListener('rendererlost', onRendererLost);

var renderers = {};

var mute=false;
var speed=1.0;
var track=1;
var volume=1.0;
function scanNetwork() {
  emptyContainer('rendererContainer');
  navigator.mediaRenderer.scanNetwork();
}

function emptyContainer(id) {
  var container = document.getElementById(id);
  while(container.hasChildNodes())
    container.removeChild(container.lastChild);
}

function openURI(id) {
  var renderer = renderers[id];
  renderer.openURI("/home/sragavan/video.avi", "");
}

function prefetchURI(id) {
  var renderer = renderers[id];
  renderer.prefetchURI("/home/sragavan/video1.mp4", "");
}

function cancel(id) {
  var renderer = renderers[id];
  renderer.cancel();
}

function play(id) {
  var renderer = renderers[id];
  var controller = renderer.controller;
  controller.play();
}

function pause(id) {
  var renderer = renderers[id];
  var controller = renderer.controller;
  controller.pause();
}
function stop(id) {
  var renderer = renderers[id];
  var controller = renderer.controller;
  controller.stop();
}
function next(id) {
  var renderer = renderers[id];
  var controller = renderer.controller;
  controller.next();
}
function previous(id) {
  var renderer = renderers[id];
  var controller = renderer.controller;
  controller.previous();
}

function mute(id) {

  if (mute)
    mute = false;
  else
    mute = true;
  var renderer = renderers[id];
  var controller = renderer.controller;
  controller.mute(mute);
}

function setSpeed(id) {
  if (speed > 0.9)
    speed = 0.5;
  else
    speed = 1.0;
  var renderer = renderers[id];
  var controller = renderer.controller;
  controller.setSpeed(speed);
}

function setVolume(id) {
  if (volume > 0.9)
    volume = 0.5;
  else
    volume = 1.0;
  var renderer = renderers[id];
  var controller = renderer.controller;
  controller.setVolume(volume);
}

function gotoTrack(id) {
  if (track == 1)
    track = 2;
  else
    track = 1;
  var renderer = renderers[id];
  var controller = renderer.controller;
  controller.gotoTrack(track);
}

function addButton(container, event, name, action) {
  var button = document.createElement('button');
  button.innerHTML = name;
  button.id = event.renderer.id;
  button.setAttribute('onclick', action);  
  container.appendChild(button);  
}

function onRendererFound(event) {
  var container = document.getElementById('rendererContainer');
  var rendererControls = document.createElement('div');
  renderers[event.renderer.id] = event.renderer;
  rendererControls.id = event.renderer.id;
  rendererControls.innerHTML = 'Renderer: ' + event.renderer.friendlyName;
  container.appendChild(rendererControls);

  addButton(rendererControls, event, 'Open', 'openURI(this.id)');
  addButton(rendererControls, event, 'Prefetch', 'prefetchURI(this.id)');
  addButton(rendererControls, event, 'Cancel', 'cancel(this.id)');
  addButton(rendererControls, event, 'Play', 'play(this.id)');  
  addButton(rendererControls, event, 'Pause', 'pause(this.id)');
  addButton(rendererControls, event, 'Stop', 'stop(this.id)');
  addButton(rendererControls, event, 'Next', 'next(this.id)');
  addButton(rendererControls, event, 'Previous', 'openURI(this.id)');
  addButton(rendererControls, event, 'Mute', 'mute(this.id)');  
  addButton(rendererControls, event, 'setSpeed', 'setSpeed(this.id)');
  addButton(rendererControls, event, 'setVolume', 'setVolume(this.id)');
  addButton(rendererControls, event, 'gotoTrack', 'gotoTrack(this.id)');

}

function onRendererLost(event) {
  var button = document.getElementById(event.id);
  document.removeChild(button);
}

</script>

</body>
</html>
